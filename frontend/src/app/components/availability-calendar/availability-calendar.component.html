<div class="calendar-container">
    <h2>Disponibilidad del Local</h2>

    <!-- Control de Fecha -->
    <div class="date-picker-container">
        <label for="date-input">Seleccionar Fecha:</label>
        <input 
            type="date" 
            [(ngModel)]="selectedDate" 
            (change)="onDateChange()"
            id="date-input"
            [disabled]="loading"
        >
    </div>

    <div *ngIf="loading" class="loading-message">Cargando disponibilidad...</div>

    <div *ngIf="!loading && availability">
        <h3>Horarios para el {{ selectedDate | date:'fullDate' }}</h3>

        <!-- Leyenda de Colores -->
        <div class="color-legend">
            <span class="legend-item">
                <div class="color-box yellow-bg"></div> Pendiente (Amarillo)
            </span>
            <span class="legend-item">
                <div class="color-box green-bg"></div> Aprobado (Verde)
            </span>
            <span class="legend-item">
                <div class="color-box free-bg"></div> Disponible
            </span>
        </div>

        <!-- Lista de Slots de Horario -->
        <div class="time-slots-list">
            <div *ngFor="let slot of allSlots" 
                 class="slot-item"
                 [ngClass]="getSlotBgClass(slot)">
                
                <div class="slot-time">
                    <!-- Usamos DatePipe para formatear las horas de forma legible -->
                    {{ slot.start_dt | date:'shortTime' }} - {{ slot.end_dt | date:'shortTime' }}
                </div>

                <div class="slot-status-details">
                    <!-- Usamos el tipo para decidir qué mostrar -->
                    <span *ngIf="slot.type === 'occupied'" 
                          class="status-text"
                          [style.borderLeftColor]="getSlotColor(slot)"> 
                        
                        <!-- Muestra Estado y Usuario -->
                        {{ getSlotDetails(slot) }}
                    </span>
                    
                    <span *ngIf="slot.type === 'available'" class="status-text status-free">
                        LIBRE
                    </span>
                </div>
            </div>
        </div>
        
        <!-- Mensaje si no hay slots -->
        <div *ngIf="allSlots.length === 0" class="no-slots-message">
            No hay horarios de operación o reservas para la fecha seleccionada.
        </div>
    </div>
</div>
