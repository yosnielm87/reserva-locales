<div class="availability-calendar">
    <h3>Disponibilidad del Local</h3>

    <div class="date-selector">
        <label for="date-input">Seleccionar Fecha:</label>
        <!-- (ngModelChange) llama a la función onDateChange() para recargar la disponibilidad -->
        <input type="date" id="date-input" [(ngModel)]="selectedDate" (ngModelChange)="onDateChange()">
    </div>

    <div *ngIf="loading" class="loading-indicator">Cargando disponibilidad...</div>

    <div *ngIf="!loading && allSlots.length === 0" class="no-data">
        No se encontró disponibilidad para la fecha seleccionada.
    </div>

    <div *ngIf="!loading && allSlots.length > 0" class="slots-container">
        <h4>Horarios Ordenados:</h4>
        <!-- Itera sobre todos los slots (disponibles y ocupados) -->
        <div *ngFor="let slot of allSlots" 
             class="slot-item" 
             [class.available]="slot.type === 'available'" 
             [class.occupied]="slot.type === 'occupied'">
            
            <div class="time-range">
                {{ slot.start_dt | date:'shortTime' }} - {{ slot.end_dt | date:'shortTime' }}
            </div>
            
            <div class="status">
                <span *ngIf="slot.type === 'available'">LIBRE</span>
                <!-- Llama a la función getSlotStatus del TS para obtener el estado de forma segura -->
                <span *ngIf="slot.type === 'occupied'">
                    OCUPADO ({{ getSlotStatus(slot) | uppercase }})
                </span>
            </div>
        </div>
    </div>
</div>
